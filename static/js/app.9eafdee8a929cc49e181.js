webpackJsonp([1],{"61ID":function(e,t){},DbfK:function(e,t){},NHnr:function(e,t,s){"use strict";function n(e){s("61ID")}function r(e){return e.toLowerCase()}function a(e){s("hJnz")}function i(e){s("ffal")}function o(e){s("DbfK"),s("v6p1")}function c(e){s("oQxR")}Object.defineProperty(t,"__esModule",{value:!0});var l=s("7+uW"),u={name:"app"},f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"theme-back",attrs:{id:"app"}},[s("router-view")],1)},d=[],h={render:f,staticRenderFns:d},v=h,p=s("VU/8"),m=n,_=p(u,v,!1,m,null,null),g=_.exports,y=s("/ocq"),C=s("mtWM"),x=s.n(C),R="https://true-words-server.herokuapp.com",b={headers:{"Content-Type":"application/json","x-truewords-id":window.twid}},w={fetchCrossReferences:function(e){return x.a.post(R+"/cross-reference",{text:e},b).then(function(e){return e.data})},fetchTexts:function(e){return x.a.get(R+"/texts/"+e.join(","),b).then(function(e){return e.data.response.search.result.passages})},search:function(e){return x.a.get(R+"/search/"+e,b).then(function(e){return e.data})},synonyms:function(e,t){var s=t?"?pos="+t:"";return x.a.get(R+"/synonyms/"+e+s,b).then(function(e){return e.data})}},S={data:function(){return{query:"",fetchedQuery:"",loading:!1,loadingSynonyms:!1,filter:"",showAdvanced:!1,pos:void 0,results:void 0,synonyms:void 0,synResults:void 0}},computed:{filteredResults:function(){var e=this;return this.filter?this.results.filter(function(t){return r(t.verse_text).includes(r(e.filter))}):this.results},filteredSynResults:function(){var e=this;return this.filter?this.synResults.filter(function(t){return r(t.verse_text).includes(r(e.filter))}):this.synResults}},methods:{highlightQuery:function(e){var t=new RegExp("("+this.fetchedQuery+")","gi"),s=new RegExp("("+this.filter+")","gi");return(this.filter?e.replace(s,'<span class="back-blue">$1</span>'):e).replace(t,'<span class="back-orange">$1</span>')},highlightSyns:function(e){var t="("+this.synonyms.join("|")+")",s=new RegExp(t,"gi"),n=new RegExp("("+this.filter+")","gi");return(this.filter?e.replace(n,'<span class="back-blue">$1</span>'):e).replace(s,'<span class="back-red">$1</span>')},togglePos:function(e){this.pos=this.pos===e?void 0:e,this.fetchSynonyms()},posClass:function(e){return this.pos===e?["back-red"]:[]},search:function(){this.loading=!0;var e=this;w.search(this.query).then(function(t){e.fetchedQuery=e.query,e.results=t[1],e.loading=!1}).catch(function(t){e.loading=!1}),this.fetchSynonyms()},fetchSynonyms:function(){var e=this;this.loadingSynonyms=!0,w.synonyms(this.query,this.pos).then(function(t){e.synonyms=t.filter(function(e){return!e.includes("antonym")&&e.length>2}),w.search(e.synonyms.join("|")).then(function(t){e.synResults=t[1],e.loadingSynonyms=!1})}).catch(function(t){e.loadingSynonyms=!1})},verseSelected:function(e){var t="https://spotlight.truewordsapp.com/#/?passage="+e.book_name+e.chapter_id+"&selection="+this.query;window.open(t,"_blank").focus()},toggleAdvanced:function(){this.showAdvanced=!this.showAdvanced}},mounted:function(){this.query=this.$route.query.q,this.query&&this.search()}},E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search flex-column"},[s("div",{staticClass:"theme-mid shadow search-form flex-column"},[s("form",{staticClass:"flex-row",on:{submit:function(t){t.preventDefault(),e.search(t)}}},[s("div",{staticClass:"flex-row flex-one align-center"},[e._m(0),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.query,expression:"query"}],staticClass:"hi-bottom flex-one",attrs:{name:"search",keyup:e.search,placeholder:"search",autocomplete:"off",autofocus:""},domProps:{value:e.query},on:{input:function(t){t.target.composing||(e.query=t.target.value)}}})]),e._v(" "),e.results?s("div",{staticClass:"filter flex-row flex-one align-center"},[e._m(1),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],staticClass:"hi-bottom flex-one",attrs:{name:"filter",placeholder:"filter"},domProps:{value:e.filter},on:{input:function(t){t.target.composing||(e.filter=t.target.value)}}}),e._v(" "),s("button",{staticClass:"callout-light font-smaller",on:{click:function(t){t.preventDefault(),e.toggleAdvanced(t)}}},[s("i",{staticClass:"fa fa-gears"})])]):e._e()]),e._v(" "),e.showAdvanced?s("div",{staticClass:"advanced hi-top"},[s("button",{staticClass:"callout-light",class:e.posClass("n"),on:{click:function(t){e.togglePos("n")}}},[e._v("Nouns")]),e._v(" "),s("button",{staticClass:"callout-light",class:e.posClass("a"),on:{click:function(t){e.togglePos("a")}}},[e._v("Adjectives")]),e._v(" "),s("button",{staticClass:"callout-light",class:e.posClass("v"),on:{click:function(t){e.togglePos("v")}}},[e._v("Verbs")])]):e._e()]),e._v(" "),e.results?s("div",{staticClass:"results flex-one flex-row vfull",class:{blur:e.loading}},[s("div",{staticClass:"flex-one flex-column"},[s("p",{staticClass:"title back-orange shadow"},[e._v(e._s(e.results.length)+" verses")]),e._v(" "),s("div",{staticClass:"flex-one substance scrolly"},e._l(e.filteredResults,function(t){return s("div",{staticClass:"verse theme-mid shadow",on:{click:function(s){e.verseSelected(t)}}},[s("span",{staticClass:"reference callout-light alt"},[e._v(e._s(t.book_name)+" "+e._s(t.chapter_id)+":"+e._s(t.verse_id))]),e._v(" "),s("span",{staticClass:"verse-text",domProps:{innerHTML:e._s(e.highlightQuery(t.verse_text))}})])}))]),e._v(" "),e.synResults?s("div",{staticClass:"synonyms flex-one flex-column",class:{faded:e.loadingSynonyms}},[s("p",{staticClass:"title back-red shadow"},[e._v(e._s(e.synonyms.length)+" synonyms, "+e._s(e.synResults.length)+" verses")]),e._v(" "),s("div",{staticClass:"flex-one substance"},e._l(e.filteredSynResults,function(t){return s("div",{staticClass:"verse theme-mid shadow"},[s("span",{staticClass:"reference callout-light alt"},[e._v(e._s(t.book_name)+" "+e._s(t.chapter_id)+":"+e._s(t.verse_id))]),e._v(" "),s("span",{staticClass:"verse-text",domProps:{innerHTML:e._s(e.highlightSyns(t.verse_text))}})])}))]):e._e()]):e._e(),e._v(" "),s("transition",{attrs:{name:"fade"}},[e.loading?s("div",{staticClass:"loading theme-mid"},[s("i",{staticClass:"fa fa-circle-o-notch fa-spin fa-3x callout-light alt"})]):e._e()])],1)},k=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("button",{staticClass:"callout-light",attrs:{type:"submit"}},[s("i",{staticClass:"fa fa-search"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{staticClass:"muted",attrs:{for:"filter"}},[s("i",{staticClass:"fa fa-filter blue"})])}],T={render:E,staticRenderFns:k},q=T,$=s("VU/8"),P=a,A=$(S,q,!1,P,null,null),D=A.exports,j=s("Dd8w"),N=s.n(j),F=s("NYxO"),Q={name:"TextDump",data:function(){return{text:""}},methods:N()({},Object(F.b)(["setCrossReferences"]),{update:function(e){this.text=e},fetchCrossReferences:function(){var e=this;w.fetchCrossReferences(this.text).then(function(t){e.setCrossReferences(t)})}})},O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-column text-dump"},[s("div",{staticClass:"text-input theme-mid flex-one shadow",attrs:{contenteditable:"true"},on:{input:function(t){e.update(t.target.innerText)}}}),e._v(" "),s("button",{staticClass:"callout-light shadow-long",on:{click:e.fetchCrossReferences}},[e._v("submit")])])},V=[],H={render:O,staticRenderFns:V},M=H,U=s("VU/8"),L=i,J=U(Q,M,!1,L,"data-v-30cd58f2",null),z=J.exports,I=s("gRE1"),K=s.n(I),W={name:"CrossReferences",data:function(){return{verses:[]}},computed:N()({},Object(F.c)(["crossReferences"])),watch:{crossReferences:function(){var e=this,t=[];K()(this.crossReferences).forEach(function(e){t=t.concat(e)}),w.fetchTexts(t).then(function(t){e.verses=t})}},methods:{formatted:function(e){return e},verseText:function(e){if(this.verses&&this.verses.length){var t=e.split("-"),s=this.verses.find(function(e){return e.start_verse_id.includes(t[0])&&(2!==t.length||e.end_verse_id.includes(t[1]))});return s?s.text:void 0}}}},Y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"cross-references"},e._l(e.crossReferences,function(t,n){return s("div",{staticClass:"hi-bottom topic-group theme-mid"},[s("p",{staticClass:"topic callout-light"},[e._v(e._s(n))]),e._v(" "),e._l(t,function(t){return s("div",{staticClass:"verse hi-bottom"},[s("p",{staticClass:"verse-ref"},[e._v(e._s(e.formatted(t[0])))]),e._v(" "),s("transition",{attrs:{name:"fade"}},[s("div",{staticClass:"verse-text",domProps:{innerHTML:e._s(e.verseText(t[0]))}})])],1)})],2)}))},B=[],G={render:Y,staticRenderFns:B},X=G,Z=s("VU/8"),ee=o,te=Z(W,X,!1,ee,"data-v-775ebcb8",null),se=te.exports,ne={name:"TextCrossReference",components:{TextDump:z,CrossReferences:se}},re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"vfull flex-row"},[s("text-dump",{staticClass:"flex-one"}),e._v(" "),s("cross-references",{staticClass:"theme-mid shadow"})],1)},ae=[],ie={render:re,staticRenderFns:ae},oe=ie,ce=s("VU/8"),le=c,ue=ce(ne,oe,!1,le,"data-v-9e63360e",null),fe=ue.exports;l.a.use(y.a);var de=new y.a({routes:[{path:"/",name:"Search",component:D},{path:"/cross-reference",name:"TextCrossReference",component:fe}]});l.a.use(F.a);var he={crossReferences:{}},ve={crossReferences:function(e){return e.crossReferences}},pe={setCrossReferences:function(e,t){(0,e.commit)("SET_CROSS_REFERENCES",t)}},me={SET_CROSS_REFERENCES:function(e,t){e.crossReferences=t}},_e=new F.a.Store({state:he,getters:ve,mutations:me,actions:pe});l.a.config.productionTip=!1,new l.a({el:"#app",store:_e,router:de,template:"<App/>",components:{App:g}})},ffal:function(e,t){},hJnz:function(e,t){},oQxR:function(e,t){},v6p1:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.9eafdee8a929cc49e181.js.map